# RDBMS_Modeling

## 관계형 데이터베이스 (Relational Database)

## 특징

1. 고유 식별자
   - 테이블이 각 행(레코드)를 식별하기 위한 고유 식별자(Key)를 정의할 수 있다

2. 참조 무결성
   - 테이블과 테이블간의 관계에서 나타난다
   - 참조되는 테이블의 외래 키값은 참조하는 테이블에 정의된 고유 식별자의 값의 범위(도메인)를 벗어날 수 없다

### Table(Entity)

Column 속성 여러 개로 구성된 레코드들의 집합
- Column
  - 테이블의 속성들의 집합 
  - 세로열 데이터
  - 필드, 속성
- Row
  - 하나의 속성들의 집합을 모아놓은 행 
  - 가로열 데이터
  - 튜플, 레코드

### Primary Key(주 식별자, PK)

테이블 등록 시 명시해 주어야하는 속성이며, 하나의 레코드를 고유하게 구분할 수 있는 것이다.

- 주로 ID를 예로 생각할 수 있다
- Not Null & Unique 
- Key는 key에 대응하는 인덱스 테이블(index)이 생성된다
  - 인덱스 테이블은 키 값에 의해서 정렬되어 있다.
  - 빠른 검색을 위해
- Determinant
  - 이 값을 알면 나머지 속성 값도 알 수 있다
  - 즉, dependency가 존재한다
- `PK가 없으면 관계를 설정할 수 없다`

## Primary Key 설계

### 고려사항

- 유일하고, 모든 레코드에 `NOT NULL`인 컬럼을 찾아야한다
  - 후보 식별자가 없는 경우 임의의 식별자를 만들어 부여할 수 있다 (인조식별자)
  - 사실 이런 경우가 더 많다
- PK의 데이터 타입 결정
  - 레코드의 발생 가능한 최대 수를 예측해야한다
    - 한달에, 1년에 몇 개 정도 발생하는가?
    - 처리해야하는 대상이 대략 몇 개정도 되는가?
  - int 등의 숫자를 PK로 채택할 경우 자동 증가 속서을 사용할 수 있다
    - 특별한 의미를 부여해야하는 경우 String을 사용하고, 이외에는 정수형이 바람직하다.

> PK를 구성하는데 반드시 하나의 column만을 사용하는 것은 아니다.
> 한 개 이상들의 column들이 모여서 unique & notnull을 만족하면 여러 개의 column을 묶어서 PK로 사용하는 경우도 존재한다.
  
## Relation(관계)

### 1:M 관계

- 부모 - 자식 관계, 종속관계, 트리구조, Has-A 관계
- 하나의 테이블이 다른 테이블의 여러 객체를 갖는 것을 의미한다
  - 가장 흔하게 나타나는 매우 일반적인 관계
- 관계가 있는 테이블에서, 1:M에서 1테이블의 PK가 M테이블의 foreign key(FK)가 된다
  - `참조 무결성`: FK는 PK의 범주에서 벗어날 수 없다

### 1:M의 재귀적인 관계

- 1 : M관계의 M이 1이 되어 하위의 N을 가지는 관계
  - 분류 코드
    - 대분류, 중분류, 소분류
  - 디렉토리
- 이 경우 어떻게 테이블을 구현해야할까?
  - 자기 테이블내에 자기 자신을 가리키는 PK와 FK를 동시에 가지는 방법
    - 부서 ID(PK), 부서명, 상위 부서 ID(FK)
    - 상위 부서 ID는 FK이지만, 결과적으로 같은 테이블의 PK를 가리킨다
  - 즉 한 테이블내에, 모든 데이터가 저장된다

### M:N 관계

- 한 테이블에서 다른 테이블을 봐도 1:M, 반대 테이블에서 봐도 1:M인 관계
  - 학생과 과목 테이블을 생각해보면, 학생은 여러 과목을 수강할 수 있다
  - 과목입장에서도 한 과목에 여러학생이 등록될 수 있다.
- 그런데 생각해보면, PK와 FK와의 관계를 통해 RDBMS가 구성되는데 이 경우는 어떻게 되는걸까?
  - 이를 해결하기 위해선 `중간 테이블` 한 개 필요하다
  - 학생 <-> 수강신청 <-> 과목
- `M:N을 1:M + M:1 관계로 나눠줘야한다`
- M:N 관계는 사실상, 관계가 없는 두 테이블을 특정 비지니스로직을 넣는 경우 발생한다.
  - 따라서 관계없는 두 테이블간에 중간 테이블을 이용해 관계를 연결해줄 수 있다.

> 중간 테이블 또한 Sequence가 PK가 되어 다른 테이블의 FK가 될 수 있다